{"ast":null,"code":"\"use strict\"; // Copyright 2020 Google LLC\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Discovery = void 0;\n\nconst fs = require(\"fs\");\n\nconst google_auth_library_1 = require(\"google-auth-library\");\n\nconst resolve = require(\"url\");\n\nconst util = require(\"util\");\n\nconst apirequest_1 = require(\"./apirequest\");\n\nconst endpoint_1 = require(\"./endpoint\");\n\nconst readFile = util.promisify(fs.readFile);\n\nclass Discovery {\n  /**\n   * Discovery for discovering API endpoints\n   *\n   * @param options Options for discovery\n   */\n  constructor(options) {\n    this.transporter = new google_auth_library_1.DefaultTransporter();\n    this.options = options || {};\n  }\n  /**\n   * Generate and Endpoint from an endpoint schema object.\n   *\n   * @param schema The schema from which to generate the Endpoint.\n   * @return A function that creates an endpoint.\n   */\n\n\n  makeEndpoint(schema) {\n    return options => {\n      const ep = new endpoint_1.Endpoint(options);\n      ep.applySchema(ep, schema, schema, ep);\n      return ep;\n    };\n  }\n  /**\n   * Log output of generator. Works just like console.log\n   */\n\n\n  log() {\n    if (this.options && this.options.debug) {\n      console.log(...arguments);\n    }\n  }\n  /**\n   * Generate all APIs and return as in-memory object.\n   * @param discoveryUrl\n   */\n\n\n  async discoverAllAPIs(discoveryUrl) {\n    const headers = this.options.includePrivate ? {} : {\n      'X-User-Ip': '0.0.0.0'\n    };\n    const res = await this.transporter.request({\n      url: discoveryUrl,\n      headers\n    });\n    const items = res.data.items;\n    const apis = await Promise.all(items.map(async api => {\n      const endpointCreator = await this.discoverAPI(api.discoveryRestUrl);\n      return {\n        api,\n        endpointCreator\n      };\n    }));\n    const versionIndex = {}; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    const apisIndex = {};\n\n    for (const set of apis) {\n      if (!apisIndex[set.api.name]) {\n        versionIndex[set.api.name] = {};\n\n        apisIndex[set.api.name] = options => {\n          const type = typeof options;\n          let version;\n\n          if (type === 'string') {\n            version = options;\n            options = {};\n          } else if (type === 'object') {\n            version = options.version;\n            delete options.version;\n          } else {\n            throw new Error('Argument error: Accepts only string or object');\n          }\n\n          try {\n            const ep = set.endpointCreator(options, this);\n            return Object.freeze(ep); // create new & freeze\n          } catch (e) {\n            throw new Error(util.format('Unable to load endpoint %s(\"%s\"): %s', set.api.name, version, e.message));\n          }\n        };\n      }\n\n      versionIndex[set.api.name][set.api.version] = set.endpointCreator;\n    }\n\n    return apisIndex;\n  }\n  /**\n   * Generate API file given discovery URL\n   *\n   * @param apiDiscoveryUrl URL or filename of discovery doc for API\n   * @returns A promise that resolves with a function that creates the endpoint\n   */\n\n\n  async discoverAPI(apiDiscoveryUrl) {\n    if (typeof apiDiscoveryUrl === 'string') {\n      const parts = resolve.parse(apiDiscoveryUrl);\n\n      if (apiDiscoveryUrl && !parts.protocol) {\n        this.log('Reading from file ' + apiDiscoveryUrl);\n        const file = await readFile(apiDiscoveryUrl, {\n          encoding: 'utf8'\n        });\n        return this.makeEndpoint(JSON.parse(file));\n      } else {\n        this.log('Requesting ' + apiDiscoveryUrl);\n        const res = await this.transporter.request({\n          url: apiDiscoveryUrl\n        });\n        return this.makeEndpoint(res.data);\n      }\n    } else {\n      const options = apiDiscoveryUrl;\n      this.log('Requesting ' + options.url);\n      const url = options.url;\n      delete options.url;\n      const parameters = {\n        options: {\n          url,\n          method: 'GET'\n        },\n        requiredParams: [],\n        pathParams: [],\n        params: options,\n        context: {\n          google: {\n            _options: {}\n          },\n          _options: {}\n        }\n      };\n      const res = await (0, apirequest_1.createAPIRequest)(parameters);\n      return this.makeEndpoint(res.data);\n    }\n  }\n\n}\n\nexports.Discovery = Discovery;","map":{"version":3,"names":["Object","defineProperty","exports","value","Discovery","fs","require","google_auth_library_1","resolve","util","apirequest_1","endpoint_1","readFile","promisify","constructor","options","transporter","DefaultTransporter","makeEndpoint","schema","ep","Endpoint","applySchema","log","debug","console","discoverAllAPIs","discoveryUrl","headers","includePrivate","res","request","url","items","data","apis","Promise","all","map","api","endpointCreator","discoverAPI","discoveryRestUrl","versionIndex","apisIndex","set","name","type","version","Error","freeze","e","format","message","apiDiscoveryUrl","parts","parse","protocol","file","encoding","JSON","parameters","method","requiredParams","pathParams","params","context","google","_options","createAPIRequest"],"sources":["C:/Users/frexm/Desktop/ProductListing/node_modules/googleapis-common/build/src/discovery.js"],"sourcesContent":["\"use strict\";\n// Copyright 2020 Google LLC\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Discovery = void 0;\nconst fs = require(\"fs\");\nconst google_auth_library_1 = require(\"google-auth-library\");\nconst resolve = require(\"url\");\nconst util = require(\"util\");\nconst apirequest_1 = require(\"./apirequest\");\nconst endpoint_1 = require(\"./endpoint\");\nconst readFile = util.promisify(fs.readFile);\nclass Discovery {\n    /**\n     * Discovery for discovering API endpoints\n     *\n     * @param options Options for discovery\n     */\n    constructor(options) {\n        this.transporter = new google_auth_library_1.DefaultTransporter();\n        this.options = options || {};\n    }\n    /**\n     * Generate and Endpoint from an endpoint schema object.\n     *\n     * @param schema The schema from which to generate the Endpoint.\n     * @return A function that creates an endpoint.\n     */\n    makeEndpoint(schema) {\n        return (options) => {\n            const ep = new endpoint_1.Endpoint(options);\n            ep.applySchema(ep, schema, schema, ep);\n            return ep;\n        };\n    }\n    /**\n     * Log output of generator. Works just like console.log\n     */\n    log(...args) {\n        if (this.options && this.options.debug) {\n            console.log(...args);\n        }\n    }\n    /**\n     * Generate all APIs and return as in-memory object.\n     * @param discoveryUrl\n     */\n    async discoverAllAPIs(discoveryUrl) {\n        const headers = this.options.includePrivate\n            ? {}\n            : { 'X-User-Ip': '0.0.0.0' };\n        const res = await this.transporter.request({\n            url: discoveryUrl,\n            headers,\n        });\n        const items = res.data.items;\n        const apis = await Promise.all(items.map(async (api) => {\n            const endpointCreator = await this.discoverAPI(api.discoveryRestUrl);\n            return { api, endpointCreator };\n        }));\n        const versionIndex = {};\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const apisIndex = {};\n        for (const set of apis) {\n            if (!apisIndex[set.api.name]) {\n                versionIndex[set.api.name] = {};\n                apisIndex[set.api.name] = (options) => {\n                    const type = typeof options;\n                    let version;\n                    if (type === 'string') {\n                        version = options;\n                        options = {};\n                    }\n                    else if (type === 'object') {\n                        version = options.version;\n                        delete options.version;\n                    }\n                    else {\n                        throw new Error('Argument error: Accepts only string or object');\n                    }\n                    try {\n                        const ep = set.endpointCreator(options, this);\n                        return Object.freeze(ep); // create new & freeze\n                    }\n                    catch (e) {\n                        throw new Error(util.format('Unable to load endpoint %s(\"%s\"): %s', set.api.name, version, e.message));\n                    }\n                };\n            }\n            versionIndex[set.api.name][set.api.version] = set.endpointCreator;\n        }\n        return apisIndex;\n    }\n    /**\n     * Generate API file given discovery URL\n     *\n     * @param apiDiscoveryUrl URL or filename of discovery doc for API\n     * @returns A promise that resolves with a function that creates the endpoint\n     */\n    async discoverAPI(apiDiscoveryUrl) {\n        if (typeof apiDiscoveryUrl === 'string') {\n            const parts = resolve.parse(apiDiscoveryUrl);\n            if (apiDiscoveryUrl && !parts.protocol) {\n                this.log('Reading from file ' + apiDiscoveryUrl);\n                const file = await readFile(apiDiscoveryUrl, { encoding: 'utf8' });\n                return this.makeEndpoint(JSON.parse(file));\n            }\n            else {\n                this.log('Requesting ' + apiDiscoveryUrl);\n                const res = await this.transporter.request({\n                    url: apiDiscoveryUrl,\n                });\n                return this.makeEndpoint(res.data);\n            }\n        }\n        else {\n            const options = apiDiscoveryUrl;\n            this.log('Requesting ' + options.url);\n            const url = options.url;\n            delete options.url;\n            const parameters = {\n                options: { url, method: 'GET' },\n                requiredParams: [],\n                pathParams: [],\n                params: options,\n                context: { google: { _options: {} }, _options: {} },\n            };\n            const res = await (0, apirequest_1.createAPIRequest)(parameters);\n            return this.makeEndpoint(res.data);\n        }\n    }\n}\nexports.Discovery = Discovery;\n//# sourceMappingURL=discovery.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}